# 2025-08-16 Sam?

> An address identifies a substring in a file. In the following, ‘character n’ means the null string after the n-th character in the file, with 1 the first character in the file. ‘Line n’ means the n-th match, starting at the beginning of the file, of the regular expression .*\n?. All files always have a current substring, called dot, that is the default address.

## Modal Colors
sh: #44CC88
py: #CC8844
ed: #8844CC

## ed Command Structure

    [<address>]K<...>


## Sample Commands

10q -- Delete everything after the 10th line
g/re/p -- Print each line that has /re/ in it. g? Guess so.
5aSpam -- Append after line 5 'Spam\n'
5iSpan -- Insert before line 5 'Spam\n'

## Implementation notes

Code is in src/conch/sam.py.

---

## 2025-08-16 Progress Log

- Integrated Sam command parsing and buffer editing into the TUI.
- Established contract: List[str] in, List[str] out for Sam.exec.
- Developed robust extraction of plain text from RichLog/LogView for editing.
- Added tests for LogView line extraction and Sam command behavior.
- Resolved edge cases with address handling and buffer types.
- Confirmed compatibility with Textual's rendering and Rich objects.
- All tests passing; TUI and Sam integration now reliable.

## Text Manipulation Commands

From sam(1):

```man
Text commands
a/text/
or
a
lines of text
.     Insert the text into the file after the range. Set dot.
c
i     Same as a, but c replaces the text, while i inserts before the range.
d     Delete the text in the range. Set dot.
s/regexp/text/
Substitute text for the first match to the regular expression in the range. Set dot to the modified range. In text the character & stands for the string that matched the expression. Backslash behaves as usual unless followed by a digit: \d stands for the string that matched the subexpression begun by the d-th left parenthesis. If s is followed immediately by a number n, as in s2/x/y/, the n-th match in the range is substituted. If the command is followed by a g, as in s/x/y/g, all matches in the range are substituted.
m a1
t a1   Move (m) or copy (t) the range to after a1. Set dot.
```

## Next Steps
- implement s
- implement m and t
- dot managment
- allow using dot for the address (implied dot also)